# 系统优化

## 映射物理内存

网卡（PCI设备）需要用映射内存的方式访问网卡。

```cpp
// 映射物理内存页
void map_page(u32 vaddr, u32 paddr);
// 映射物理内存区域
void map_area(u32 paddr, u32 size);
```

## 内核扩容

将内核容量扩容到 500KB；

## 兼容 bochs 串口

经过调试，发现了之前 bochs 串口的错误，感觉应该是 bochs 本身模拟的问题，不过由于 bochs 时钟的问题，也发现了一些正常机器发现不了的问题，比如，**不应该在外中断处理函数中阻塞进程，应该尽可能迅速返回**，不过这要引入 **中断下半部** 的概念，目前先苟着，又不是不能用。
